<!-- wishlist.html -->

{% extends 'base/base.html' %}
{% block title %}
{% endblock title %}

{% block style %}
{% endblock style  %}


{% block content %}
<h2>My Wishlist</h2>
<ul>
  {% for item in wishlist_items %}
    <li>
      <img src="/media/{{ item.product.image }}" alt="{{ item.product.name }}" width="50">
      <span>{{ item.product.name }}</span>
      <span>â‚¹{{ item.product.price }}</span>
      <button class="remove-from-wishlist" data-product-id="{{ item.product.id }}">Remove</button>
    </li>
  {% empty %}
    <li>Your wishlist is empty.</li>
  {% endfor %}
</ul>

<script>
  document.querySelectorAll('.remove-from-wishlist').forEach(button => {
    button.addEventListener('click', function() {
      const productId = this.getAttribute('data-product-id');
      fetch(`/wishlist/remove/${productId}/`, {
        method: 'POST',
        headers: {
          'X-CSRFToken': '{{ csrf_token }}',
          'X-Requested-With': 'XMLHttpRequest'
        }
      })
      .then(response => response.json())
      .then(data => {
        alert(data.message);
        location.reload();
      });
    });
  });
</script>
{% endblock content %}


